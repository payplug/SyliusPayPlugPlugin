!function(){const e={options:{api:null,cartId:null,form:{},fieldsValid:{cardHolder:!1,pan:!1,cvv:!1,exp:!1},fieldsEmpty:{cardHolder:!0,pan:!0,cvv:!0,exp:!0},inputStyle:{default:{color:"#2B343D",fontFamily:"Poppins, Arial, sans-serif",fontSize:"14px",textAlign:"left","::placeholder":{color:"#969a9f"},":focus":{color:"#2B343D"}},invalid:{color:"#E91932"}},save_card:!1,schemes:null,scheme:null},init(){void 0!==payplug_integrated_payment_params&&(payplug_integrated_payment_params.has_saved_cards?document.querySelectorAll(".payment-choice__input").forEach((t=>{t.addEventListener("change",(t=>{"payplug_choice_card_other"===t.currentTarget.id&&t.currentTarget.checked?e.openFields():e.closeFields()}))})):(document.querySelector("[id*=sylius_checkout_select_payment_payments][value=payplug]:checked")&&e.openFields(),document.querySelectorAll("[id*=sylius_checkout_select_payment_payments]").forEach((t=>{t.addEventListener("change",(t=>{"payplug"===t.currentTarget.value&&t.currentTarget.checked?e.openFields():e.closeFields()}))}))))},openFields(){document.querySelector(".payplugIntegratedPayment").classList.add("payplugIntegratedPayment--loaded"),document.querySelector("#next-step").classList.add("disabled"),null===e.options.api&&e.load()},closeFields(){document.querySelector(".payplugIntegratedPayment").classList.remove("payplugIntegratedPayment--loaded"),document.querySelector("#next-step").classList.remove("disabled")},load(){e.options.api=integratedPaymentApi=new Payplug.IntegratedPayment(payplug_integrated_payment_params.is_test_mode),integratedPaymentApi.setDisplayMode3ds(Payplug.DisplayMode3ds.LIGHTBOX),e.options.form.cardHolder=integratedPaymentApi.cardHolder(document.querySelector(".cardHolder-input-container"),{default:e.options.inputStyle.default,placeholder:payplug_integrated_payment_params.cardholder}),e.options.form.pan=integratedPaymentApi.cardNumber(document.querySelector(".pan-input-container"),{default:e.options.inputStyle.default,placeholder:payplug_integrated_payment_params.pan}),e.options.form.cvv=integratedPaymentApi.cvv(document.querySelector(".cvv-input-container"),{default:e.options.inputStyle.default,placeholder:payplug_integrated_payment_params.cvv}),e.options.form.exp=integratedPaymentApi.expiration(document.querySelector(".exp-input-container"),{default:e.options.inputStyle.default,placeholder:payplug_integrated_payment_params.exp}),e.options.schemes=integratedPaymentApi.getSupportedSchemes(),e.bindEvents(),e.fieldValidation()},bindEvents(){document.querySelector("#paid").addEventListener("click",(e=>{e.preventDefault(),integratedPaymentApi.validateForm()})),integratedPaymentApi.onValidateForm((async({isFormValid:t})=>{if(t){if(e.options.scheme=document.querySelector("#savecard").checked,void 0!==payplug_integrated_payment_params.payment_id)return void integratedPaymentApi.pay(payplug_integrated_payment_params.payment_id,e.options.scheme,{save_card:e.options.save_card});e.options.save_card=document.querySelector("[name=schemeOptions]:checked").value;const t=await fetch(payplug_integrated_payment_params.routes.init_payment,{method:"POST"}),a=await t.json();integratedPaymentApi.pay(a.payment_id,e.options.scheme,{save_card:e.options.save_card})}})),integratedPaymentApi.onCompleted((e=>{e.error?console.error(e.error):(document.querySelector("input[name=payplug_integrated_payment_token]").value=e.token,document.querySelector("form[name=sylius_checkout_select_payment]").submit())}))},fieldValidation(){$.each(e.options.form,(function(t,a){a.onChange((function(a){a.error?(document.querySelector(`.payplugIntegratedPayment__error--${t}`).classList.remove("payplugIntegratedPayment__error--hide"),document.querySelector(`.${t}-input-container`).classList.add("payplugIntegratedPayment__container--invalid"),"FIELD_EMPTY"===a.error.name?(document.querySelector(`.payplugIntegratedPayment__error--${t}`).querySelector(".emptyField").classList.remove("payplugIntegratedPayment__error--hide"),document.querySelector(`.payplugIntegratedPayment__error--${t}`).querySelector(".invalidField").classList.add("payplugIntegratedPayment__error--hide")):(document.querySelector(`.payplugIntegratedPayment__error--${t}`).querySelector(".invalidField").classList.remove("payplugIntegratedPayment__error--hide"),document.querySelector(`.payplugIntegratedPayment__error--${t}`).querySelector(".emptyField").classList.add("payplugIntegratedPayment__error--hide"))):(document.querySelector(`.payplugIntegratedPayment__error--${t}`).classList.add("payplugIntegratedPayment__error--hide"),document.querySelector(`.${t}-input-container`).classList.remove("payplugIntegratedPayment__container--invalid"),document.querySelector(`.payplugIntegratedPayment__error--${t}`).querySelector(".invalidField").classList.add("payplugIntegratedPayment__error--hide"),document.querySelector(`.payplugIntegratedPayment__error--${t}`).querySelector(".emptyField").classList.add("payplugIntegratedPayment__error--hide"),e.options.fieldsValid[t]=!0,e.options.fieldsEmpty[t]=!1)}))}))}};document.addEventListener("DOMContentLoaded",e.init,!1)}();